# QA Bot —Å RAG

–°–∏—Å—Ç–µ–º–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RAG (Retrieval-Augmented Generation) –¥–ª—è —Ç–æ—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫** - –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ FAISS –∏ BGE-M3
- ü§ñ **LLM –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Ollama –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- üéØ **–î–≤–æ–π–Ω–æ–π —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥** - –≤—ã–±–æ—Ä –º–µ–∂–¥—É cross-encoder –∏ LLM-based —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–æ–º
- üìä **–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞** - BLEURT, SAS, ROUGE-L –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤
- üñ•Ô∏è **–£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - Tkinter GUI —Å 3 –ø–∞–Ω–µ–ª—è–º–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **Semantic Search** (`src/retriever/semantic_search.py`)
   - –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ FAISS
   - –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ —á–µ—Ä–µ–∑ BGE-M3
   - –ü–µ—Ä–≤–∏—á–Ω—ã–π –ø–æ–∏—Å–∫ —Ç–æ–ø-N –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

2. **LLM Reranker** (`src/llm/llm_reranker_vllm.py`)
   - –ü–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ vLLM
   - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–º–µ–Ω–∞ cross-encoder

3. **Chat Bot** (`src/llm/llm_chat_bot_ollama.py`)
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ Ollama
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ retriever

4. **Metrics** (`src/retriever/metrics.py`)
   - BLEURT-20 –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞
   - SAS (Semantic Answer Similarity)
   - ROUGE-L —Å —Ä—É—Å—Å–∫–∏–º —Å—Ç–µ–º–º–∏–Ω–≥–æ–º
   - nDCG, MRR, MAP –¥–ª—è retrieval –º–µ—Ç—Ä–∏–∫

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ß–µ—Ä–µ–∑ Docker Compose

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –≤ Ollama
docker exec -it qa_bot_ollama ollama pull llama3.2:3b

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ http://localhost:8000
```

### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -e .

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
python run_app.py
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –ß–∞—Ç
- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –≤–æ–ø—Ä–æ—Å–æ–≤
- –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ —Å AI

### –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–≤–µ—Ä—Ö) - –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã
- –¢–æ–ø-5 –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
- –û—Ü–µ–Ω–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å LLM —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–∞

### –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–Ω–∏–∑) - –ú–µ—Ç—Ä–∏–∫–∏
- –£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- Retrieval –º–µ—Ç—Ä–∏–∫–∏

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### BuildConfig
```python
BuildConfig(
    batch_size=32,           # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
    force_cpu=False,         # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ CPU
    rerank_device="cuda",    # –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–∞
    use_fp16_rerank=True,    # FP16 –¥–ª—è —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–∞
    chunk_size=500,          # –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞
    overlap_size=50          # –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —á–∞–Ω–∫–æ–≤
)
```

### MetricConfig
```python
MetricConfig(
    bleurt_ckpt="BLEURT-20",
    sas_model="BAAI/bge-m3",
    sas_device="cuda",
    sas_fp16=True
)
```

## –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```python
from src.retriever.semantic_search import SemanticSearch
from src.schemas.pydantic_schemas import BuildConfig

config = BuildConfig(
    batch_size=32,
    force_cpu=False,
    rerank_device="cuda",
    use_fp16_rerank=True,
    chunk_size=500,
    overlap_size=50
)

search = SemanticSearch("./index", config)

# –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
with open("your_document.txt", "r", encoding="utf-8") as f:
    text = f.read()
    search.build_from_text(text)
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Python 3.12
- PyTorch 2.7.0
- FAISS –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
- FlagEmbedding (BGE-M3)
- Ollama –¥–ª—è LLM
- vLLM –¥–ª—è —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–∞
- BLEURT –¥–ª—è –º–µ—Ç—Ä–∏–∫

## –°–µ—Ä–≤–∏—Å—ã

- **app** (–ø–æ—Ä—Ç 8000) - –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **ollama** (–ø–æ—Ä—Ç 11434) - LLM —Å–µ—Ä–≤–µ—Ä
- **vllm** (–ø–æ—Ä—Ç 8001) - —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä

## –ê–≤—Ç–æ—Ä—ã

- –ù–∞–±–∏–µ–≤ –†–∞—à–∏–¥—Ö–æ–Ω (nabievrasheed@yandex.ru)
- –ù–∏–∫–∏—Ç–∏–Ω –ë–æ—Ä–∏—Å

## –õ–∏—Ü–µ–Ω–∑–∏—è

–°–º. —Ñ–∞–π–ª LICENSE
